<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Fit Foods - Custom Meal Plan Quiz</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * { font-family: 'Plus Jakarta Sans', sans-serif; }
        .font-display { font-family: 'Playfair Display', serif; }
        
        @keyframes fadeInUp {
          from { opacity: 0; transform: translateY(30px); }
          to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideInRight {
          from { opacity: 0; transform: translateX(-20px); }
          to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
        
        .animate-fadeInUp { animation: fadeInUp 0.6s ease-out forwards; }
        .animate-slideInRight { animation: slideInRight 0.5s ease-out forwards; }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        
        .stagger-1 { animation-delay: 0.1s; opacity: 0; }
        .stagger-2 { animation-delay: 0.2s; opacity: 0; }
        .stagger-3 { animation-delay: 0.3s; opacity: 0; }
        .stagger-4 { animation-delay: 0.4s; opacity: 0; }
        
        .btn-primary {
          background: #6B7B5E;
          transition: all 0.3s ease;
          position: relative;
          overflow: hidden;
        }
        
        .btn-primary:hover {
          background: #5A6A4D;
          transform: translateY(-2px);
          box-shadow: 0 12px 24px rgba(107, 123, 94, 0.3);
        }
        
        .card-hover {
          transition: all 0.3s ease;
          cursor: pointer;
        }
        
        .card-hover:hover {
          transform: translateY(-4px);
          box-shadow: 0 16px 32px rgba(0, 0, 0, 0.12);
        }
        
        .progress-bar {
          background: linear-gradient(90deg, #6B7B5E 0%, #8B9B7E 0%);
          transition: all 0.5s ease;
        }
        
        .line-clamp-2 {
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          overflow: hidden;
        }
        
        @media (max-width: 768px) {
          .meal-card-mobile { font-size: 0.875rem; }
          .meal-card-mobile .meal-emoji { font-size: 2.5rem; }
        }
    </style>
</head>
<body class="bg-[#F5F3EE]">
    <div id="root"></div>

    <script>
        // Simple state management
        let state = {
            step: 0,
            formData: {
                zipCode: '',
                goal: '',
                obstacle: '',
                proteins: [],
                avoidances: [],
                mealPlan: '',
                email: '',
                phone: '',
                selectedMeals: []
            },
            isServiceable: null,
            timeLeft: 900,
            activePeople: 47
        };

        const meals = [
            { id: 1, name: "Grilled Chicken & Sweet Potato", protein: 42, calories: 420, tags: ["chicken", "comfort"], image: "üçó", popular: true },
            { id: 2, name: "Beef Taco Bowl", protein: 38, calories: 450, tags: ["beef", "tex-mex"], image: "üåÆ", popular: true },
            { id: 3, name: "Salmon & Asparagus", protein: 40, calories: 380, tags: ["seafood", "light"], image: "üêü" },
            { id: 4, name: "Turkey Meatballs", protein: 35, calories: 410, tags: ["chicken", "italian"], image: "üçù" },
            { id: 5, name: "Breakfast Power Bowl", protein: 32, calories: 390, tags: ["eggs", "breakfast"], image: "üç≥", popular: true },
            { id: 6, name: "Bison Burger Bowl", protein: 45, calories: 460, tags: ["beef", "comfort"], image: "üçî" },
            { id: 7, name: "Shrimp Stir Fry", protein: 36, calories: 370, tags: ["seafood", "asian"], image: "üç§" },
            { id: 8, name: "Chicken Fajita Bowl", protein: 40, calories: 425, tags: ["chicken", "tex-mex"], image: "üåØ", popular: true },
            { id: 9, name: "Turkey Quinoa Bowl", protein: 38, calories: 400, tags: ["chicken", "healthy"], image: "ü•ó" },
            { id: 10, name: "Beef & Broccoli", protein: 41, calories: 440, tags: ["beef", "asian"], image: "ü•¶" },
            { id: 11, name: "Garlic Shrimp Zoodles", protein: 34, calories: 360, tags: ["seafood", "light"], image: "ü¶ê" },
            { id: 12, name: "Chicken Teriyaki", protein: 39, calories: 430, tags: ["chicken", "asian"], image: "üç±" },
            { id: 13, name: "Steak & Eggs", protein: 44, calories: 470, tags: ["beef", "eggs", "breakfast"], image: "ü•©" },
            { id: 14, name: "Grilled Salmon Bowl", protein: 42, calories: 395, tags: ["seafood", "healthy"], image: "üê†" },
            { id: 15, name: "BBQ Chicken", protein: 37, calories: 415, tags: ["chicken", "comfort"], image: "üçó" },
            { id: 16, name: "Turkey Chili", protein: 36, calories: 385, tags: ["chicken", "comfort"], image: "üå∂Ô∏è" },
        ];

        const transformations = [
            { name: "Maddie", lost: "231 lbs", fatLoss: "36%", image: "üë©", rating: 5 },
            { name: "Blake", lost: "20 lbs fat", gained: "20 lbs muscle", fatLoss: "10.6%", image: "üßî", rating: 5 },
            { name: "Bethany", lost: "83 lbs", quote: "I've gained so much mental clarity", image: "üë©‚Äçü¶∞", rating: 5 },
            { name: "Jamil", lost: "106 lbs", fatLoss: "26%", image: "üßë", rating: 5 },
        ];

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function checkZipCode(zip) {
            const serviceableZips = ['77', '78', '79', '75', '80', '97'];
            return serviceableZips.some(prefix => zip.startsWith(prefix));
        }

        function autoSelectMeals() {
            const mealCount = 
                state.formData.mealPlan === 'starter' ? 10 :
                state.formData.mealPlan === 'results' ? 15 :
                state.formData.mealPlan === 'commit' ? 20 :
                state.formData.mealPlan === 'shared' ? 30 : 45;
            
            let filteredMeals = meals.filter(meal => {
                const matchesProtein = state.formData.proteins.length === 0 || 
                    state.formData.proteins.some(pref => meal.tags.includes(pref)) ||
                    state.formData.proteins.includes('any');
                
                const matchesAvoidances = !state.formData.avoidances.some(avoid => {
                    if (avoid.includes('No beef')) return meal.tags.includes('beef');
                    if (avoid.includes('No seafood')) return meal.tags.includes('seafood');
                    if (avoid.includes('No pork')) return meal.tags.includes('pork');
                    return false;
                });
                
                return matchesProtein && matchesAvoidances;
            });
            
            if (filteredMeals.length < mealCount) {
                filteredMeals = [...filteredMeals, ...meals.filter(m => !filteredMeals.includes(m))];
            }
            
            state.formData.selectedMeals = filteredMeals.slice(0, mealCount).map(m => m.id);
        }

        function handleNext() {
            state.step++;
            if (state.step === 9 && state.formData.selectedMeals.length === 0) {
                autoSelectMeals();
            }
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function handleBack() {
            state.step--;
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateFormData(field, value) {
            state.formData[field] = value;
            render();
        }

        function toggleArrayValue(field, value) {
            const current = state.formData[field];
            if (current.includes(value)) {
                state.formData[field] = current.filter(v => v !== value);
            } else {
                state.formData[field] = [...current, value];
            }
            render();
        }

        // Silent version for multi-select steps - updates visuals without full render
        function toggleArrayValueSilent(field, value, buttonId) {
            const current = state.formData[field];
            const button = document.getElementById(buttonId);
            
            if (current.includes(value)) {
                // Remove from array
                state.formData[field] = current.filter(v => v !== value);
                // Update button visual
                if (button) {
                    button.classList.remove('border-[#6B7B5E]', 'bg-green-50');
                    button.classList.add('border-gray-200');
                    const checkmark = button.querySelector('.checkmark');
                    if (checkmark) checkmark.remove();
                }
            } else {
                // Add to array
                state.formData[field] = [...current, value];
                // Update button visual
                if (button) {
                    button.classList.remove('border-gray-200');
                    button.classList.add('border-[#6B7B5E]', 'bg-green-50');
                    // Add checkmark if not exists
                    if (!button.querySelector('.checkmark')) {
                        const icon = button.querySelector('.text-2xl') || button.querySelector('.text-xl');
                        if (icon) {
                            const checkmark = document.createElement('span');
                            checkmark.className = 'checkmark text-[#6B7B5E] text-2xl';
                            checkmark.textContent = '‚úì';
                            icon.insertAdjacentElement('afterend', checkmark);
                        }
                    }
                }
            }
            
            // Update Continue button state for proteins
            if (field === 'proteins') {
                const continueBtn = document.getElementById('proteins-continue-btn');
                if (continueBtn) {
                    continueBtn.disabled = state.formData.proteins.length === 0;
                    if (state.formData.proteins.length === 0) {
                        continueBtn.classList.add('disabled:opacity-50', 'disabled:cursor-not-allowed');
                    } else {
                        continueBtn.classList.remove('disabled:opacity-50', 'disabled:cursor-not-allowed');
                    }
                }
            }
        }

        // OPTION A: Let browser handle input - no render on keystroke
        function handleZipInput(value) {
            // Clean and update state silently
            value = value.replace(/\D/g, '').slice(0, 5);
            state.formData.zipCode = value;
            
            // Update validation message only (not entire page)
            const validationEl = document.getElementById('zip-validation');
            const nextBtn = document.getElementById('zip-next-btn');
            
            if (value.length === 5) {
                state.isServiceable = checkZipCode(value);
                if (validationEl) {
                    validationEl.innerHTML = state.isServiceable 
                        ? '<div class="mt-6 p-4 rounded-xl bg-green-50 border-2 border-green-200"><p class="text-center font-semibold text-green-800">üéâ Great news! We deliver fresh meals daily or you can pick up in-store.</p></div>'
                        : '<div class="mt-6 p-4 rounded-xl bg-red-50 border-2 border-red-200"><p class="text-center font-semibold text-red-800">üòî We\'re sorry: We don\'t deliver to your area yet! Join our waitlist...</p></div>';
                }
                if (nextBtn) {
                    nextBtn.disabled = !state.isServiceable;
                    nextBtn.className = state.isServiceable 
                        ? 'w-full btn-primary text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl'
                        : 'w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl';
                }
            } else {
                state.isServiceable = null;
                if (validationEl) validationEl.innerHTML = '';
                if (nextBtn) {
                    nextBtn.disabled = true;
                    nextBtn.className = 'w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl';
                }
            }
            
            // NO render() call - browser handles the typing naturally!
        }

        // Similar approach for email
        function handleEmailInput(value) {
            state.formData.email = value;
            const nextBtn = document.getElementById('email-next-btn');
            if (nextBtn) {
                const isValid = value && value.includes('@');
                nextBtn.disabled = !isValid;
                nextBtn.className = isValid
                    ? 'w-full btn-primary text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl'
                    : 'w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl';
            }
        }

        function handlePhoneInput(value) {
            state.formData.phone = value;
            // No validation needed, it's optional
        }

        function toggleMeal(mealId) {
            const index = state.formData.selectedMeals.indexOf(mealId);
            if (index > -1) {
                state.formData.selectedMeals.splice(index, 1);
            } else {
                state.formData.selectedMeals.push(mealId);
            }
            render();
        }

        function handleCheckout() {
            alert('üéâ Proceeding to secure checkout!\n\n' + 
                  `You've selected ${state.formData.selectedMeals.length} meals.\n` +
                  `Total: $${(state.formData.selectedMeals.length * 6.75).toFixed(2)}\n\n` +
                  'This is a demo - in production, this would redirect to checkout.');
        }

        function renderHero() {
            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-12">
                    <div class="max-w-5xl w-full">
                        <div class="text-center space-y-6 animate-fadeInUp">
                            <div class="flex items-center justify-center gap-2 text-sm text-gray-600 mb-2">
                                <div class="flex -space-x-2">
                                    <div class="w-8 h-8 rounded-full bg-[#6B7B5E] flex items-center justify-center border-2 border-white text-xs">üë®</div>
                                    <div class="w-8 h-8 rounded-full bg-[#6B7B5E] flex items-center justify-center border-2 border-white text-xs">üë©</div>
                                    <div class="w-8 h-8 rounded-full bg-[#6B7B5E] flex items-center justify-center border-2 border-white text-xs">üßî</div>
                                    <div class="w-8 h-8 rounded-full bg-[#6B7B5E] flex items-center justify-center border-2 border-white text-xs">üë©‚Äçü¶∞</div>
                                </div>
                                <span class="font-semibold">Join 15,000+ people who transformed their health</span>
                            </div>

                            <div class="inline-block bg-gradient-to-r from-red-600 to-orange-600 text-white px-8 py-3 rounded-full text-base font-bold tracking-wide mb-4 animate-pulse">
                                ‚ö° LIMITED TIME: 40% OFF YOUR FIRST ORDER
                            </div>
                            
                            <h1 class="font-display text-4xl sm:text-5xl md:text-7xl text-gray-800 leading-tight">
                                Get a Custom Eating Plan<br />
                                <span class="text-[#6B7B5E]">Tailored To Your Goals</span>
                            </h1>
                            
                            <p class="text-lg sm:text-xl md:text-2xl text-gray-600 max-w-2xl mx-auto font-medium">
                                Answer 6 quick questions and get access to <span class="font-bold text-[#6B7B5E]">40g+ protein</span> meals for as low as <span class="font-bold text-green-600">$6.75 each!</span>
                            </p>
                            
                            <div class="flex flex-wrap justify-center gap-3 sm:gap-6 text-xs sm:text-sm font-semibold text-gray-600 mt-6">
                                <div class="flex items-center gap-2 bg-white px-3 sm:px-4 py-2 rounded-full shadow-sm">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>Fresh Daily</span>
                                </div>
                                <div class="flex items-center gap-2 bg-white px-3 sm:px-4 py-2 rounded-full shadow-sm">
                                    <span class="text-[#6B7B5E]">‚ö°</span>
                                    <span>40g+ Protein</span>
                                </div>
                                <div class="flex items-center gap-2 bg-white px-3 sm:px-4 py-2 rounded-full shadow-sm">
                                    <span class="text-[#6B7B5E]">üõ°Ô∏è</span>
                                    <span>Never Frozen</span>
                                </div>
                                <div class="flex items-center gap-2 bg-white px-3 sm:px-4 py-2 rounded-full shadow-sm">
                                    <span class="text-[#6B7B5E]">üèÜ</span>
                                    <span>No Seed Oils</span>
                                </div>
                            </div>

                            <div class="bg-white rounded-2xl p-6 max-w-2xl mx-auto shadow-lg">
                                <div class="flex items-center justify-center gap-1 mb-2">
                                    <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                    <span class="ml-2 text-sm font-bold text-gray-800">4.9/5 from 3,247 reviews</span>
                                </div>
                                <p class="text-sm text-gray-600 italic">"Life-changing meals. Lost 40 lbs in 3 months!" - Sarah M.</p>
                            </div>
                            
                            <button
                                onclick="handleNext()"
                                class="btn-primary text-white px-10 sm:px-16 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center gap-3 mt-6 shadow-xl"
                            >
                                Get My Custom Plan Now
                                <span>‚Üí</span>
                            </button>

                            <p class="text-xs text-gray-600 mt-4">‚è±Ô∏è Takes only 60 seconds ‚Ä¢ üîí No credit card required</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderZipStep() {
            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-2xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center text-sm text-gray-600 font-semibold">
                            Step 1 of 6 ‚Ä¢ 17% Complete
                        </div>

                        <div class="text-center space-y-4">
                            <div class="inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-[#6B7B5E] rounded-full mb-4">
                                <span class="text-3xl sm:text-4xl text-white">üìç</span>
                            </div>
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                First, where are we<br class="hidden sm:block" /> fueling you?
                            </h2>
                            <p class="text-base sm:text-lg text-gray-600">
                                We use your ZIP to show accurate delivery and pickup options near you.
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-3xl shadow-xl p-6 sm:p-8">
                            <input
                                id="zip-input"
                                type="text"
                                placeholder="Enter ZIP code"
                                oninput="handleZipInput(this.value)"
                                maxlength="5"
                                class="w-full text-center text-2xl sm:text-3xl font-bold px-4 sm:px-6 py-3 sm:py-4 border-2 border-gray-200 rounded-2xl focus:border-[#6B7B5E] focus:outline-none transition-colors"
                                autofocus
                            />
                            
                            <div id="zip-validation"></div>
                        </div>
                        
                        <div class="text-center text-sm text-gray-600">
                            <span class="inline-block mr-1">üîí</span>
                            Your information is secure and private
                        </div>
                        
                        <button
                            id="zip-next-btn"
                            onclick="handleNext()"
                            disabled
                            class="w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl"
                        >
                            Continue to My Custom Plan
                            <span>‚Üí</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function renderGoalsStep() {
            const goals = [
                { value: 'fat-loss', label: 'Lose body fat / see the scale move', icon: 'üìâ', popular: true },
                { value: 'recomp', label: 'Tone up / recomposition', icon: 'üéØ' },
                { value: 'muscle', label: 'Build muscle & strength', icon: 'üí™' },
                { value: 'energy', label: 'Eat healthier & have more energy', icon: '‚≠ê', popular: true },
                { value: 'convenience', label: 'Stop relying on takeout', icon: 'üçî' },
                { value: 'health', label: 'Support overall health markers', icon: '‚ù§Ô∏è' },
            ];

            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-4xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center text-sm text-gray-600 font-semibold">
                            Step 2 of 6 ‚Ä¢ 33% Complete
                        </div>

                        <div class="text-center space-y-4">
                            <div class="inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-[#6B7B5E] rounded-full mb-4">
                                <span class="text-3xl sm:text-4xl">üéØ</span>
                            </div>
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                What's your #1 goal over<br class="hidden sm:block" />the next 30-90 days?
                            </h2>
                            <p class="text-sm sm:text-base text-gray-600">Choose the goal that resonates most with you</p>
                        </div>
                        
                        <div class="grid sm:grid-cols-2 gap-3 sm:gap-4">
                            ${goals.map((goal, idx) => `
                                <button
                                    onclick="state.formData.goal = '${goal.value}'; handleNext()"
                                    class="card-hover bg-white p-4 sm:p-6 rounded-2xl text-left border-2 border-gray-200 transition-all relative animate-slideInRight stagger-${(idx % 4) + 1}"
                                >
                                    ${goal.popular ? '<div class="absolute -top-2 right-2 bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-bold">POPULAR</div>' : ''}
                                    <div class="flex items-start gap-3 sm:gap-4">
                                        <div class="flex-shrink-0 w-10 h-10 sm:w-12 sm:h-12 bg-[#6B7B5E] bg-opacity-10 rounded-xl flex items-center justify-center text-2xl">
                                            ${goal.icon}
                                        </div>
                                        <span class="text-base sm:text-lg font-semibold text-gray-800 flex-1">${goal.label}</span>
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                        
                        <button
                            onclick="handleBack()"
                            class="w-full bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                        >
                            ‚Üê Back
                        </button>
                    </div>
                </div>
            `;
        }

        function renderObstaclesStep() {
            const obstacles = [
                { text: 'Meals that didn\'t taste good', emoji: 'üòû' },
                { text: 'Inconsistency from busy schedule', emoji: '‚è∞' },
                { text: 'Diets that were too restrictive', emoji: 'üö´' },
                { text: 'Stress or emotional eating', emoji: 'üò∞' },
                { text: 'Overwhelmed by meal prep', emoji: 'üòµ' },
                { text: 'Not knowing what to eat', emoji: '‚ùì' },
            ];

            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-4xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center text-sm text-gray-600 font-semibold">
                            Step 3 of 6 ‚Ä¢ 50% Complete
                        </div>

                        <div class="text-center space-y-4">
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                What's held you back<br class="hidden sm:block" />from your goals?
                            </h2>
                            <p class="text-sm sm:text-base text-gray-600">We'll help you overcome this obstacle</p>
                        </div>
                        
                        <div class="grid sm:grid-cols-2 gap-3 sm:gap-4">
                            ${obstacles.map((obstacle, idx) => `
                                <button
                                    onclick="state.formData.obstacle = '${obstacle.text}'; handleNext()"
                                    class="card-hover bg-white p-4 sm:p-6 rounded-2xl text-left border-2 border-gray-200 transition-all animate-slideInRight stagger-${(idx % 4) + 1}"
                                >
                                    <div class="flex items-center gap-3">
                                        <span class="text-2xl sm:text-3xl">${obstacle.emoji}</span>
                                        <span class="text-base sm:text-lg font-semibold text-gray-800">${obstacle.text}</span>
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                        
                        <button
                            onclick="handleBack()"
                            class="w-full bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                        >
                            ‚Üê Back
                        </button>
                    </div>
                </div>
            `;
        }

        function renderProteinsStep() {
            const proteins = [
                { value: 'chicken', label: 'Chicken & turkey', emoji: 'üçó' },
                { value: 'beef', label: 'Beef & bison', emoji: 'ü•©' },
                { value: 'seafood', label: 'Seafood (salmon, shrimp)', emoji: 'üêü' },
                { value: 'eggs', label: 'Eggs & breakfast-style', emoji: 'üç≥' },
                { value: 'any', label: 'I\'m open to anything!', emoji: 'üí™' },
            ];

            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-4xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center text-sm text-gray-600 font-semibold">
                            Step 4 of 6 ‚Ä¢ 67% Complete
                        </div>

                        <div class="text-center space-y-4">
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                What proteins do you<br class="hidden sm:block" />like best?
                            </h2>
                            <p class="text-sm sm:text-base text-gray-600">Select all that apply - we'll personalize your menu</p>
                        </div>
                        
                        <div class="grid sm:grid-cols-2 gap-3 sm:gap-4">
                            ${proteins.map((protein, idx) => `
                                <button
                                    id="protein-${protein.value}"
                                    onclick="toggleArrayValueSilent('proteins', '${protein.value}', 'protein-${protein.value}')"
                                    class="card-hover bg-white p-4 sm:p-6 rounded-2xl text-left border-2 ${state.formData.proteins.includes(protein.value) ? 'border-[#6B7B5E] bg-green-50' : 'border-gray-200'} transition-all animate-slideInRight stagger-${(idx % 4) + 1}"
                                >
                                    <div class="flex items-center gap-3 sm:gap-4">
                                        <span class="text-3xl sm:text-4xl">${protein.emoji}</span>
                                        <span class="text-base sm:text-lg font-semibold text-gray-800 flex-1">${protein.label}</span>
                                        ${state.formData.proteins.includes(protein.value) ? '<span class="checkmark text-[#6B7B5E] text-2xl">‚úì</span>' : ''}
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                        
                        <div class="flex gap-3 sm:gap-4">
                            <button
                                onclick="handleBack()"
                                class="flex-1 bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-6 sm:px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                            >
                                ‚Üê Back
                            </button>
                            <button
                                id="proteins-continue-btn"
                                onclick="handleNext()"
                                ${state.formData.proteins.length === 0 ? 'disabled' : ''}
                                class="flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 sm:px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3"
                            >
                                Continue
                                <span>‚Üí</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAvoidancesStep() {
            const avoidances = [
                'Dairy-free or mostly dairy-free',
                'Gluten-sensitive',
                'No pork',
                'No beef',
                'No seafood',
                'Lower sodium preferred',
                'I eat everything',
            ];

            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-4xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center text-sm text-gray-600 font-semibold">
                            Step 5 of 6 ‚Ä¢ 83% Complete
                        </div>

                        <div class="text-center space-y-4">
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                Any food preferences?
                            </h2>
                            <p class="text-sm sm:text-base text-gray-600">Select all that apply or skip</p>
                        </div>
                        
                        <div class="grid sm:grid-cols-2 gap-3 sm:gap-4">
                            ${avoidances.map((avoidance, idx) => `
                                <button
                                    id="avoidance-${idx}"
                                    onclick="toggleArrayValueSilent('avoidances', '${avoidance}', 'avoidance-${idx}')"
                                    class="card-hover bg-white p-4 sm:p-5 rounded-2xl text-left border-2 ${state.formData.avoidances.includes(avoidance) ? 'border-[#6B7B5E] bg-green-50' : 'border-gray-200'} transition-all animate-slideInRight stagger-${(idx % 4) + 1}"
                                >
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm sm:text-base font-semibold text-gray-800">${avoidance}</span>
                                        ${state.formData.avoidances.includes(avoidance) ? '<span class="checkmark text-[#6B7B5E] text-xl">‚úì</span>' : ''}
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                        
                        <div class="bg-[#6B7B5E] bg-opacity-10 rounded-2xl p-4 sm:p-6">
                            <div class="flex flex-wrap gap-3 sm:gap-4 justify-center text-xs sm:text-sm font-medium text-gray-800">
                                <div class="flex items-center gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>Fresh daily</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>40g+ protein</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>Never frozen</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>No seed oils</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex gap-3 sm:gap-4">
                            <button
                                onclick="handleBack()"
                                class="flex-1 bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-6 sm:px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                            >
                                ‚Üê Back
                            </button>
                            <button
                                onclick="handleNext()"
                                class="flex-1 btn-primary text-white px-6 sm:px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3"
                            >
                                Almost Done!
                                <span>‚Üí</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPlansStep() {
            const plans = [
                { 
                    value: 'starter', 
                    name: 'Starter Plan', 
                    meals: 10, 
                    description: 'Replace 1-2 meals daily',
                    price: '$6.75',
                    savings: '$45',
                    peopleIcon: 'üë§'
                },
                { 
                    value: 'results', 
                    name: 'Results Plan', 
                    meals: 15, 
                    description: '#1 choice for transformations',
                    price: '$6.50',
                    savings: '$67.50',
                    recommended: true,
                    peopleIcon: 'üë§'
                },
                { 
                    value: 'commit', 
                    name: 'Commit To Fit', 
                    meals: 20, 
                    description: 'For people done starting over',
                    price: '$6.25',
                    savings: '$90',
                    peopleIcon: 'üë§'
                },
                { 
                    value: 'shared', 
                    name: 'Shared Plan', 
                    meals: 30, 
                    description: 'Perfect for couples',
                    price: '$6.00',
                    savings: '$135',
                    peopleIcon: 'üë•'
                },
            ];

            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-4xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center text-sm text-gray-600 font-semibold">
                            Step 6 of 6 ‚Ä¢ 100% Complete
                        </div>

                        <div class="text-center space-y-4">
                            <div class="inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-[#6B7B5E] rounded-full mb-4">
                                <span class="text-3xl sm:text-4xl">üõí</span>
                            </div>
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                Choose Your Perfect<br class="hidden sm:block" />Weekly Plan
                            </h2>
                            <p class="text-sm sm:text-base text-gray-600">Most popular choice: <span class="font-bold text-[#6B7B5E]">15 meals/week</span></p>
                        </div>
                        
                        <div class="grid gap-4 sm:gap-6">
                            ${plans.map((plan, idx) => `
                                <button
                                    onclick="state.formData.mealPlan = '${plan.value}'; handleNext()"
                                    class="card-hover bg-white p-4 sm:p-6 rounded-2xl text-left border-2 border-gray-200 transition-all relative animate-fadeInUp stagger-${(idx % 4) + 1}"
                                >
                                    ${plan.recommended ? '<div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-gradient-to-r from-orange-500 to-red-500 text-white px-4 py-1 rounded-full text-xs font-bold shadow-lg">‚≠ê MOST POPULAR</div>' : ''}
                                    <div class="flex items-center gap-4 sm:gap-6">
                                        <div class="text-4xl sm:text-5xl">${plan.peopleIcon}</div>
                                        <div class="flex-1">
                                            <h3 class="font-display text-xl sm:text-2xl font-bold text-gray-800 mb-1">${plan.name}</h3>
                                            <p class="text-sm text-gray-600 mb-2">${plan.description}</p>
                                            <div class="flex items-baseline gap-2 flex-wrap">
                                                <span class="text-2xl sm:text-3xl font-bold text-[#6B7B5E]">${plan.meals}</span>
                                                <span class="text-xs sm:text-sm text-gray-600">meals/week</span>
                                                <span class="text-xs sm:text-sm text-gray-600">‚Ä¢</span>
                                                <span class="text-sm sm:text-base font-bold text-[#6B7B5E]">${plan.price}/meal</span>
                                            </div>
                                            <div class="text-xs sm:text-sm text-green-600 font-bold mt-1">üí∞ Save ${plan.savings} on first order</div>
                                        </div>
                                        <span class="text-2xl text-[#6B7B5E]">‚Üí</span>
                                    </div>
                                </button>
                            `).join('')}
                        </div>

                        <div class="bg-green-50 border-2 border-green-200 rounded-2xl p-4 text-center">
                            <div class="flex items-center justify-center gap-2 text-green-800 font-bold">
                                <span>üõ°Ô∏è</span>
                                <span>100% Money-Back Guarantee - Love it or get a full refund!</span>
                            </div>
                        </div>
                        
                        <button
                            onclick="handleBack()"
                            class="w-full bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                        >
                            ‚Üê Back
                        </button>
                    </div>
                </div>
            `;
        }

        function renderTransformationsStep() {
            return `
                <div class="min-h-screen px-4 py-16 sm:py-12">
                    <div class="max-w-6xl mx-auto space-y-8 sm:space-y-12 animate-fadeInUp">
                        <div class="text-center space-y-4">
                            <div class="inline-block bg-yellow-100 border-2 border-yellow-400 text-yellow-800 px-6 py-2 rounded-full text-sm font-bold mb-2">
                                ‚≠ê REAL RESULTS FROM REAL CUSTOMERS
                            </div>
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                Join Thousands Who<br />
                                <span class="text-[#6B7B5E]">Transformed Their Lives</span>
                            </h2>
                            <p class="text-base sm:text-lg text-gray-600">These results speak for themselves</p>
                        </div>
                        
                        <div class="grid sm:grid-cols-2 gap-6 sm:gap-8">
                            ${transformations.map((person, idx) => `
                                <div class="bg-white rounded-2xl shadow-xl overflow-hidden animate-fadeInUp stagger-${(idx % 4) + 1}">
                                    <div class="bg-gradient-to-br from-[#6B7B5E] to-[#8B9B7E] p-6 sm:p-8 text-white">
                                        <div class="flex items-center gap-4 mb-4">
                                            <div class="text-5xl sm:text-6xl">${person.image}</div>
                                            <div>
                                                <h3 class="font-display text-2xl sm:text-3xl font-bold">${person.name}</h3>
                                                <div class="flex gap-1 mt-1">
                                                    <span class="text-yellow-400">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                                                </div>
                                            </div>
                                        </div>
                                        ${person.quote ? `<p class="text-sm opacity-90 italic">"${person.quote}"</p>` : ''}
                                    </div>
                                    <div class="p-4 sm:p-6 space-y-3">
                                        <div class="flex items-center gap-3">
                                            <span class="text-[#6B7B5E]">üìà</span>
                                            <span class="font-semibold text-gray-800">Lost: <span class="text-[#6B7B5E] text-lg">${person.lost}</span></span>
                                        </div>
                                        ${person.gained ? `
                                            <div class="flex items-center gap-3">
                                                <span class="text-[#6B7B5E]">‚≠ê</span>
                                                <span class="font-semibold text-gray-800">Gained: <span class="text-[#6B7B5E] text-lg">${person.gained}</span></span>
                                            </div>
                                        ` : ''}
                                        ${person.fatLoss ? `
                                            <div class="flex items-center gap-3">
                                                <span class="text-[#6B7B5E]">üéØ</span>
                                                <span class="font-semibold text-gray-800">Body fat reduced: <span class="text-[#6B7B5E] text-lg">${person.fatLoss}</span></span>
                                            </div>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="bg-[#6B7B5E] rounded-2xl p-6 sm:p-8 text-white text-center">
                            <div class="text-4xl sm:text-5xl font-bold mb-2">15,000+</div>
                            <div class="text-lg sm:text-xl">People Have Already Transformed With My Fit Foods</div>
                            <div class="mt-4 text-sm opacity-90">Join them today and get 40% off your first order!</div>
                        </div>
                        
                        <div class="text-center">
                            <button
                                onclick="handleNext()"
                                class="btn-primary text-white px-10 sm:px-16 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center gap-3 shadow-xl"
                            >
                                Claim My 40% OFF & Select Meals
                                <span>‚Üí</span>
                            </button>
                        </div>
                        
                        <button
                            onclick="handleBack()"
                            class="w-full max-w-md mx-auto block bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                        >
                            ‚Üê Back
                        </button>
                    </div>
                </div>
            `;
        }

        function renderEmailStep() {
            return `
                <div class="min-h-screen flex items-center justify-center px-4 py-16 sm:py-12">
                    <div class="max-w-2xl w-full space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center space-y-4">
                            <div class="inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-[#6B7B5E] to-[#8B9B7E] rounded-full mb-4">
                                <span class="text-3xl sm:text-4xl">üìß</span>
                            </div>
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                Claim Your 40% OFF<br class="hidden sm:block" />Discount Code! üéâ
                            </h2>
                            <p class="text-base sm:text-lg text-gray-600">
                                Enter your email to unlock your personalized meal plan and exclusive discount
                            </p>
                        </div>
                        
                        <div class="bg-white rounded-3xl shadow-2xl p-6 sm:p-8 space-y-6">
                            <div>
                                <label class="block text-sm font-bold text-gray-800 mb-2">Email Address *</label>
                                <input
                                    type="email"
                                    placeholder="your@email.com"
                                    oninput="handleEmailInput(this.value)"
                                    class="w-full px-4 sm:px-6 py-3 sm:py-4 border-2 border-gray-200 rounded-xl focus:border-[#6B7B5E] focus:outline-none transition-colors text-base sm:text-lg"
                                    autofocus
                                />
                            </div>
                            
                            <div>
                                <label class="block text-sm font-bold text-gray-800 mb-2">Phone Number (Optional)</label>
                                <input
                                    type="tel"
                                    placeholder="(555) 123-4567"
                                    oninput="handlePhoneInput(this.value)"
                                    class="w-full px-4 sm:px-6 py-3 sm:py-4 border-2 border-gray-200 rounded-xl focus:border-[#6B7B5E] focus:outline-none transition-colors text-base sm:text-lg"
                                />
                                <p class="text-xs sm:text-sm text-gray-600 mt-2 flex items-center gap-1">
                                    üì± Get delivery updates & exclusive VIP offers
                                </p>
                            </div>

                            <div class="flex items-center justify-center gap-4 text-xs text-gray-600 pt-4 border-t border-gray-200">
                                <div class="flex items-center gap-1">
                                    <span>üîí</span>
                                    <span>Secure & Private</span>
                                </div>
                                <span>‚Ä¢</span>
                                <div class="flex items-center gap-1">
                                    <span>üõ°Ô∏è</span>
                                    <span>No Spam Guarantee</span>
                                </div>
                            </div>
                        </div>
                        
                        <button
                            id="email-next-btn"
                            onclick="handleNext()"
                            disabled
                            class="w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-4 sm:py-5 rounded-full text-base sm:text-lg font-bold inline-flex items-center justify-center gap-3 shadow-xl"
                        >
                            üéâ Unlock My 40% OFF & See My Meals
                            <span>‚Üí</span>
                        </button>

                        <p class="text-xs text-center text-gray-600">
                            By continuing, you agree to receive emails about your order and special offers.
                        </p>
                        
                        <button
                            onclick="handleBack()"
                            class="w-full bg-white text-[#6B7B5E] border-2 border-[#6B7B5E] px-8 py-3 sm:py-4 rounded-full text-base sm:text-lg font-semibold hover:bg-gray-50 transition-all"
                        >
                            ‚Üê Back
                        </button>
                    </div>
                </div>
            `;
        }

        function renderMealsStep() {
            const selectedMeals = meals.filter(m => state.formData.selectedMeals.includes(m.id));
            const availableMeals = meals.filter(m => !state.formData.selectedMeals.includes(m.id));
            const targetMealCount = 
                state.formData.mealPlan === 'starter' ? 10 :
                state.formData.mealPlan === 'results' ? 15 :
                state.formData.mealPlan === 'commit' ? 20 :
                state.formData.mealPlan === 'shared' ? 30 : 45;

            return `
                <div class="min-h-screen px-4 py-16 sm:py-12 pb-32">
                    <div class="max-w-7xl mx-auto space-y-6 sm:space-y-8 animate-fadeInUp">
                        <div class="text-center space-y-4">
                            <div class="inline-block bg-green-100 border-2 border-green-500 text-green-800 px-4 sm:px-6 py-2 rounded-full text-xs sm:text-sm font-bold mb-2">
                                ‚úì MEALS PRE-SELECTED BASED ON YOUR PREFERENCES
                            </div>
                            <h2 class="font-display text-3xl sm:text-4xl md:text-5xl text-gray-800">
                                Your Custom Meal Plan<br class="hidden sm:block" />
                                <span class="text-[#6B7B5E]">Is Ready!</span>
                            </h2>
                            <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">
                                Don't like something? Remove it and browse below to swap in your favorites.
                            </p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-[#6B7B5E] to-[#8B9B7E] rounded-2xl p-4 sm:p-6 text-white">
                            <h3 class="font-display text-lg sm:text-2xl font-bold mb-3 sm:mb-4">Your Personalized Plan</h3>
                            <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4 text-xs sm:text-sm">
                                <div>
                                    <div class="opacity-80 mb-1">Your Goal</div>
                                    <div class="font-semibold capitalize">${state.formData.goal?.replace('-', ' ') || 'Not specified'}</div>
                                </div>
                                <div>
                                    <div class="opacity-80 mb-1">Proteins</div>
                                    <div class="font-semibold capitalize">${state.formData.proteins.slice(0, 2).join(', ') || 'All'}</div>
                                </div>
                                <div>
                                    <div class="opacity-80 mb-1">Weekly Meals</div>
                                    <div class="font-semibold text-lg sm:text-xl">${targetMealCount} meals</div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-display text-xl sm:text-2xl font-bold text-gray-800 mb-4 flex items-center gap-3">
                                <span class="bg-[#6B7B5E] text-white w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center text-sm">
                                    ${state.formData.selectedMeals.length}
                                </span>
                                Your Selected Meals
                            </h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4">
                                ${selectedMeals.map(meal => `
                                    <div class="meal-card-mobile bg-white rounded-xl sm:rounded-2xl shadow-lg overflow-hidden border-2 border-[#6B7B5E] transition-all">
                                        <div class="bg-gradient-to-br from-[#F5F3EE] to-[#E5E3DE] p-4 sm:p-6 text-center relative">
                                            <div class="absolute top-1 right-1 sm:top-2 sm:right-2 bg-green-500 text-white w-5 h-5 sm:w-6 sm:h-6 rounded-full flex items-center justify-center text-xs">‚úì</div>
                                            ${meal.popular ? '<div class="absolute top-1 left-1 sm:top-2 sm:left-2 bg-orange-500 text-white px-2 py-0.5 rounded-full text-[10px] sm:text-xs font-bold">TOP</div>' : ''}
                                            <div class="meal-emoji text-4xl sm:text-6xl mb-2">${meal.image}</div>
                                            <div class="inline-block bg-[#6B7B5E] text-white px-2 py-0.5 sm:px-3 sm:py-1 rounded-full text-[10px] sm:text-xs font-bold">${meal.protein}g</div>
                                        </div>
                                        <div class="p-2 sm:p-4 space-y-2">
                                            <h3 class="font-bold text-xs sm:text-base text-gray-800 leading-tight line-clamp-2">${meal.name}</h3>
                                            <div class="text-[10px] sm:text-sm text-gray-600">${meal.calories} cal</div>
                                            <button
                                                onclick="toggleMeal(${meal.id})"
                                                class="w-full py-2 sm:py-3 rounded-lg sm:rounded-xl font-semibold transition-all bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 text-xs sm:text-sm"
                                            >
                                                <span class="flex items-center justify-center gap-1">
                                                    <span>‚úï</span>
                                                    Remove
                                                </span>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        ${availableMeals.length > 0 ? `
                            <div>
                                <h3 class="font-display text-xl sm:text-2xl font-bold text-gray-800 mb-4">
                                    Browse & Swap Meals
                                </h3>
                                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-4">
                                    ${availableMeals.map(meal => `
                                        <div class="meal-card-mobile bg-white rounded-xl sm:rounded-2xl shadow-lg overflow-hidden border-2 border-gray-200 transition-all card-hover">
                                            <div class="bg-gradient-to-br from-[#F5F3EE] to-[#E5E3DE] p-4 sm:p-6 text-center relative">
                                                ${meal.popular ? '<div class="absolute top-1 left-1 sm:top-2 sm:left-2 bg-orange-500 text-white px-2 py-0.5 rounded-full text-[10px] sm:text-xs font-bold">TOP</div>' : ''}
                                                <div class="meal-emoji text-4xl sm:text-6xl mb-2">${meal.image}</div>
                                                <div class="inline-block bg-[#6B7B5E] text-white px-2 py-0.5 sm:px-3 sm:py-1 rounded-full text-[10px] sm:text-xs font-bold">${meal.protein}g</div>
                                            </div>
                                            <div class="p-2 sm:p-4 space-y-2">
                                                <h3 class="font-bold text-xs sm:text-base text-gray-800 leading-tight line-clamp-2">${meal.name}</h3>
                                                <div class="text-[10px] sm:text-sm text-gray-600">${meal.calories} cal</div>
                                                <button
                                                    onclick="toggleMeal(${meal.id})"
                                                    class="w-full py-2 sm:py-3 rounded-lg sm:rounded-xl font-semibold transition-all bg-[#F5F3EE] text-[#6B7B5E] hover:bg-[#6B7B5E] hover:text-white text-xs sm:text-sm"
                                                >
                                                    Add to Plan
                                                </button>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                        
                        <div class="bg-[#6B7B5E] bg-opacity-10 rounded-2xl p-4 sm:p-8 text-center">
                            <p class="font-display text-lg sm:text-2xl md:text-3xl text-gray-800 italic">
                                "Consistency beats willpower. The easiest way to stay on track is having meals ready that you actually enjoy."
                            </p>
                            <div class="flex flex-wrap gap-2 sm:gap-4 justify-center mt-4 sm:mt-6 text-xs sm:text-sm font-medium text-gray-800">
                                <div class="flex items-center gap-1 sm:gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>Fresh daily</span>
                                </div>
                                <div class="flex items-center gap-1 sm:gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>40g+ protein</span>
                                </div>
                                <div class="flex items-center gap-1 sm:gap-2">
                                    <span class="text-[#6B7B5E]">‚úì</span>
                                    <span>Never frozen</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="fixed bottom-0 left-0 w-full bg-white border-t-2 border-gray-200 p-3 sm:p-6 shadow-2xl z-40">
                        <div class="max-w-7xl mx-auto">
                            <div class="flex items-center justify-between gap-2 sm:gap-4">
                                <div class="text-center flex-1">
                                    <div class="text-[10px] sm:text-sm text-gray-600">Meals</div>
                                    <div class="text-xl sm:text-3xl font-bold text-gray-800">
                                        ${state.formData.selectedMeals.length}
                                        <span class="text-xs sm:text-lg text-gray-600 ml-1">/ ${targetMealCount}</span>
                                    </div>
                                </div>
                                <div class="text-center flex-1">
                                    <div class="text-[10px] sm:text-sm text-gray-600">Total (40% OFF)</div>
                                    <div class="text-xl sm:text-3xl font-bold text-[#6B7B5E]">
                                        $${(state.formData.selectedMeals.length * 6.75).toFixed(2)}
                                    </div>
                                    <div class="text-[9px] sm:text-xs text-green-600">Save $${(state.formData.selectedMeals.length * 4.50).toFixed(2)}</div>
                                </div>
                                <button
                                    onclick="handleCheckout()"
                                    ${state.formData.selectedMeals.length === 0 ? 'disabled' : ''}
                                    class="btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-white px-4 sm:px-12 py-3 sm:py-4 rounded-full text-sm sm:text-lg font-bold inline-flex items-center gap-2 flex-1 justify-center"
                                >
                                    <span class="hidden sm:inline">Continue to Checkout</span>
                                    <span class="sm:hidden">Checkout</span>
                                    <span>üõí</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function render() {
            const root = document.getElementById('root');
            
            let content = '';
            
            // Urgency bar
            if (state.step > 0) {
                content += `
                    <div class="fixed top-0 left-0 w-full bg-gradient-to-r from-red-600 to-orange-600 text-white py-2 px-4 z-50 text-center text-sm font-semibold">
                        <div class="flex items-center justify-center gap-2 flex-wrap">
                            <span>‚è±Ô∏è</span>
                            <span>40% OFF expires in <span class="timer-display">${formatTime(state.timeLeft)}</span></span>
                            <span class="hidden sm:inline">‚Ä¢</span>
                            <span class="flex items-center gap-1">
                                <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                                <span class="people-counter">${state.activePeople}</span> people claiming this offer now
                            </span>
                        </div>
                    </div>
                `;
                
                content += `
                    <div class="fixed top-10 left-0 w-full h-1.5 bg-gray-200 z-40">
                        <div class="progress-bar h-full" style="width: ${(state.step / 10) * 100}%; background: linear-gradient(90deg, #6B7B5E 0%, #8B9B7E ${(state.step / 10) * 100}%)"></div>
                    </div>
                `;
            }
            
            // Render current step
            switch(state.step) {
                case 0: content += renderHero(); break;
                case 1: content += renderZipStep(); break;
                case 2: content += renderGoalsStep(); break;
                case 3: content += renderObstaclesStep(); break;
                case 4: content += renderProteinsStep(); break;
                case 5: content += renderAvoidancesStep(); break;
                case 6: content += renderPlansStep(); break;
                case 7: content += renderTransformationsStep(); break;
                case 8: content += renderEmailStep(); break;
                case 9: content += renderMealsStep(); break;
                default: content += '<div class="min-h-screen flex items-center justify-center"><h1 class="text-4xl font-bold">Thank you!</h1></div>';
            }
            
            root.innerHTML = content;
        }

        // Update only timer display without re-rendering
        setInterval(() => {
            if (state.timeLeft > 0) {
                state.timeLeft--;
                const timerElements = document.querySelectorAll('.timer-display');
                timerElements.forEach(el => {
                    if (el) el.textContent = formatTime(state.timeLeft);
                });
            }
        }, 1000);

        // Update only people counter without re-rendering
        setInterval(() => {
            state.activePeople = 43 + Math.floor(Math.random() * 8);
            const counterElements = document.querySelectorAll('.people-counter');
            counterElements.forEach(el => {
                if (el) el.textContent = state.activePeople;
            });
        }, 5000);

        // Initial render
        render();
    </script>
</body>
</html>
